getabspath() {
	typeset A IFS=/ T I=0
	[[ $1 == /* ]] && A=${1#/} || A=${PWD#/}/$1

	while
		__=${A%%/*}

		case $__ in
		..)
			[[ I -gt 0 ]] && unset 'T[--I]'
			;;
		.|'')
			;;
		*)
			T[I++]=$__
			;;
		esac

		[[ $A == */* ]]
	do
		A=${A#*/}
	done

	case $1 in
	*/)
		[[ I -gt 0 ]] && __="/${T2[*]}/" || __=/
		;;
	*)
		[[ I -gt 0 ]] && __="/${T2[*]}" || __=/.
		;;
	esac
}
